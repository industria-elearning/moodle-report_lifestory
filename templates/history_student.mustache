{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template report_student_life_story_ai/history_student

    Example context (json):
    {
    }
}}

<form method="get" action="{{selecturl}}" class="mb-4">
    <div class="d-flex align-items-center flex-wrap justify-content-between gap-3">

        <div class="d-flex align-items-center flex-wrap gap-3">
            <div class="d-flex align-items-center">
                <label for="userid" class="form-label mb-0 me-2 fw-bold">
                    {{#str}} user {{/str}}:
                </label>
                <select name="userid" id="userid"
                        class="form-control d-inline-block w-auto"
                        onchange="this.form.submit()">
                    {{#users}}
                        <option value="{{id}}" {{#selected}}selected{{/selected}}>{{name}}</option>
                    {{/users}}
                </select>
            </div>

            {{#hasuser}}
            <div class="d-flex align-items-center gap-2 ms-3">
                <a href="{{processurl}}?userid={{userid}}&action=feedback"
                   class="btn btn-primary me-2"
                   id="btn-feedback-ai"
                   data-loader-text="{{#str}} generatingfeedback, report_student_life_story_ai {{/str}}">
                    {{#str}} generatefeedback, report_student_life_story_ai {{/str}}
                </a>
                <a href="{{processurl}}?userid={{userid}}&action=csv"
                   class="btn btn-success"
                   id="btn-csv-export"
                   data-loader-text="{{#str}} exportingcsv, report_student_life_story_ai {{/str}}">
                    {{#str}} exportcsv, report_student_life_story_ai {{/str}}
                </a>
            </div>
            {{/hasuser}}
        </div>

        {{#hasuser}}
        {{#headerlogo}}
        <div class="d-flex align-items-center ms-auto">
            <img src="{{logourl}}" alt="Logo Datacurso"
                 class="plugin-logo" style="max-height: 38px;">
        </div>
        {{/headerlogo}}
        {{/hasuser}}

    </div>
</form>

{{^hasuser}}
<div class="alert alert-info">
    {{#str}} selectuser, report_student_life_story_ai {{/str}}
</div>
{{/hasuser}}

{{#hasuser}}
    {{#showfeedback}}
    <div class="alert alert-info mb-4 p-3">
        <h5 class="mb-3">{{#str}} feedbackfromai, report_student_life_story_ai {{/str}}</h5>
        <pre class="bg-light p-3 rounded mb-0">{{{feedback}}}</pre>
    </div>
    {{/showfeedback}}

    {{#courses}}
    <div class="mb-5">
        <h4 class="mb-3">{{fullname}}</h4>
        <div class="report-table border rounded p-3 bg-white shadow-sm">
            {{{reporthtml}}}
        </div>
    </div>
    {{/courses}}
{{/hasuser}}

