<form method="get" action="{{selecturl}}" class="mb-4">
    <div class="d-flex align-items-center flex-wrap gap-3">
        <div class="d-flex align-items-center">
            <label for="userid" class="form-label mb-0 me-2 fw-bold">
                {{#str}} user {{/str}}:
            </label>
            <select name="userid" id="userid"
                    class="form-control d-inline-block w-auto"
                    onchange="this.form.submit()">
                {{#users}}
                    <option value="{{id}}" {{#selected}}selected{{/selected}}>{{name}}</option>
                {{/users}}
            </select>
        </div>

        {{#hasuser}}
        <div class="d-flex align-items-center gap-2 ms-3">
            <a href="{{processurl}}?userid={{userid}}&action=feedback"
               class="btn btn-primary me-2">
                {{#str}} generatefeedback, report_history_student_ai {{/str}}
            </a>
            <a href="{{processurl}}?userid={{userid}}&action=csv"
               class="btn btn-success">
                {{#str}} exportcsv, report_history_student_ai {{/str}}
            </a>
        </div>
        {{/hasuser}}
    </div>
</form>

{{^hasuser}}
<div class="alert alert-info">
    {{#str}} selectuser, report_history_student_ai {{/str}}
</div>
{{/hasuser}}

{{#hasuser}}
    {{#showfeedback}}
    <div class="alert alert-info mb-4 p-3">
        <h5 class="mb-3">{{#str}} feedbackfromai, report_history_student_ai {{/str}}</h5>
        <pre class="bg-light p-3 rounded mb-0">{{{feedback}}}</pre>
    </div>
    {{/showfeedback}}

    {{#courses}}
    <div class="mb-5">
        <h4 class="mb-3">{{fullname}}</h4>
        <div class="report-table border rounded p-3 bg-white shadow-sm">
            {{{reporthtml}}}
        </div>
    </div>
    {{/courses}}
{{/hasuser}}
