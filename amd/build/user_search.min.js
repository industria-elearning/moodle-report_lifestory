/**
 * User search functionality for lifestory report.
 *
 * @module     report_lifestory/user_search
 * @copyright  2025 Datacurso
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_lifestory/user_search",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){let searchTimeout=null;return{init:function(baseUrl){const searchInput=$("#usersearch"),clearButton=$("#clearsearch"),resultsContainer=$("#search-results");0!==searchInput.length&&(searchInput.on("input",(function(){const query=$(this).val().trim();if(!(query.length>0))return clearButton.hide(),void resultsContainer.addClass("d-none").empty();clearButton.show(),searchTimeout&&clearTimeout(searchTimeout),searchTimeout=setTimeout((function(){(function(query){return Ajax.call([{methodname:"report_lifestory_search_students",args:{query:query}}])[0]})(query).then((function(response){!function(results,baseUrl){const container=$("#search-results");if(container.empty(),!results||0===results.length)return void container.addClass("d-none");let html="";results.forEach((function(student){const avatar=student.profileimageurl?'<img src="'.concat(student.profileimageurl,'" alt="').concat(student.fullname,'"\n                         class="rounded-circle me-3" style="width:40px; height:40px; object-fit:cover;">'):'<div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-3"\n                         style="width:40px; height:40px; flex-shrink:0; font-size:18px; font-weight:bold;">\n                         '.concat(student.fullname.charAt(0).toUpperCase(),"\n                   </div>");html+='\n                <a href="'.concat(baseUrl,"?userid=").concat(student.id,'"\n                   class="d-block p-2 text-decoration-none border-bottom"\n                   style="color: inherit; transition: background-color 0.15s;">\n                    <div class="d-flex align-items-center">\n                        ').concat(avatar,'\n                        <div>\n                            <div class="fw-bold">').concat(student.fullname,'</div>\n                            <small class="text-muted">').concat(student.email,"</small>\n                        </div>\n                    </div>\n                </a>\n            ")})),container.html(html).removeClass("d-none"),container.find("a").hover((function(){$(this).css("background-color","#f8f9fa")}),(function(){$(this).css("background-color","")}))}(response&&response.students?response.students:[],baseUrl)})).catch(Notification.exception)}),300)})),clearButton.on("click",(function(e){e.preventDefault(),searchInput.val(""),clearButton.hide(),resultsContainer.addClass("d-none").empty(),searchInput.focus()})),searchInput.on("focus",(function(){$(this).val().trim().length>0&&resultsContainer.children().length>0&&resultsContainer.removeClass("d-none")})),$(document).on("click",(function(e){$(e.target).closest("#usersearch-wrapper").length||resultsContainer.addClass("d-none")})),searchInput.on("keydown",(function(e){"Enter"===e.key&&e.preventDefault()})))}}}));

//# sourceMappingURL=user_search.min.js.map